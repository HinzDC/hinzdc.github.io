# Enable TLSv1.2 for compatibility with older clients
[Net.ServicePointManager]::SecurityProtocol = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::Tls12
cls
# Tentukan URL unduhan IDM
$idmDownloadUrl = "https://www.internetdownloadmanager.com/download.html"

# Unduh halaman unduhan IDM
Write-Host ""
Write-Host ""
Write-Host ""
Write-Host ""
Write-Host "                                                 " -BackgroundColor DarkRed
Write-Host "            IDM DOWNLOAD + ACTIVATION            " -BackgroundColor DarkRed -ForegroundColor White
Write-Host "                    HINZDC.XYZ                   " -BackgroundColor DarkRed -ForegroundColor White
Write-Host "                                                 " -BackgroundColor DarkRed
Write-Host "-----------------------------------------"
Write-Host " Mengunduh halaman unduhan IDM..."
Write-Host "-----------------------------------------"
Write-Host ""
Write-Host ""
$pageContent = Invoke-WebRequest -Uri $idmDownloadUrl

# Temukan tautan unduhan dari halaman
$downloadLink = $pageContent.Links | Where-Object { $_.Href -like "*idman*"} | Select-Object -First 1

# Unduh file IDM
$idmInstallerUrl = $downloadLink.Href
$downloadPath = "$env:USERPROFILE\Downloads\IDMInstaller.exe"
Write-Host " Mengunduh file instalasi IDM..."
Write-Host "-----------------------------------------"
Write-Host ""
Write-Host ""
Invoke-WebRequest -Uri $idmInstallerUrl -OutFile $downloadPath

# Jalankan installer IDM
Write-Host " Menjalankan installer IDM..."
Write-Host "-----------------------------------------"
Write-Host ""
Write-Host ""

cmd /c "set idmcheck=tasklist /fi ""imagename eq idman.exe"" | findstr /i ""idman.exe"" >nul" ; if ($env:idmcheck) { taskkill /f /im idman.exe /t }

Start-Process -FilePath $downloadPath -ArgumentList "/skipdlgs" -Wait

# Hapus file installer setelah instalasi selesai (opsional)
Write-Host " Instalasi IDM selesai."
Write-Host "-----------------------------------------"
Remove-Item -Path $downloadPath
Write-Host ""
Write-Host ""
Write-Host " Start Activation IDM."
Write-Host "-----------------------------------------"
Write-Host ""
Write-Host ""
Start-Sleep -Seconds 5
& ([ScriptBlock]::Create((irm https://massgrave.dev/ias))) /act

$ActScript = {
    # Script dari URL
    $scriptFromURL = [ScriptBlock]::Create((irm https://massgrave.dev/ias))
    & $scriptFromURL /act

    # Script tambahan
    reg add "HKEY_CURRENT_USER\Software\DownloadManager" /v "TipStartUp" /t REG_DWORD /d 1 /f
    reg add "HKEY_CURRENT_USER\Software\DownloadManager" /v "LstCheck" /t REG_SZ /d "31/12/99" /f
}

# Menjalankan script utama
& $actScript

$wshell = New-Object -ComObject Wscript.Shell
$wshell.Popup("IDM Sudah Terinstall Dan Teraktivasi. Harap untuk tidak melakukan update pada IDM..",3,"OLIH X SARGA//~")
exit
